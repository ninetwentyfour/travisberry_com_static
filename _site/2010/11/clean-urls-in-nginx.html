<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Clean URL's in Nginx | Travis Berry</title>
    <meta name="author" content="Travis Berry">
    <!-- Mobile viewport optimized: j.mp/bplateviewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="http://travisberry.heroku.com/feed.rss" rel="alternate" title="RSS" type="application/rss+xml" />
    
    <link href="http://static.travisberry.com/sites/4ddebc054a2ab10001000007/theme/stylesheets/stylev2.css" media="screen" rel="stylesheet" type="text/css" />
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->
    <!--[if lte IE 7]>
    ie
    <![endif]-->
    <style>
			.gist-meta{
			  font-size:8px !important;
			  text-shadow: none !important;
			}

		</style>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
    </head>
      <body>
        <div id="topBar">
          
          <a href="http://localhost:4000/2011/05/create-github-gist-with-ruby.html"><img src="http://www.travisberry.com/wp-content/uploads/2011/05/gists.jpg" alt="Create GitHub Gist With Ruby" title="Create GitHub Gist With Ruby" width=20 height=20 /></a>
          
          <a href="http://localhost:4000/2011/05/write-text-anywhere-with-html5-canvas.html"><img src="http://www.travisberry.com/wp-content/uploads/2011/05/canvas.jpg" alt="Write Text Anywhere With HTML5 Canvas" title="Write Text Anywhere With HTML5 Canvas" width=20 height=20 /></a>
          
          <a href="http://localhost:4000/2011/03/a-day-in-the-life-of-me.html"><img src="http://static.travisberry.com/sites/4ddebc054a2ab10001000007/assets/4de4286bd48c1200010000c7/selfhomecrop2.jpg" alt="A Day In The Life Of Me" title="A Day In The Life Of Me" width=20 height=20 /></a>
          
          <a href="http://localhost:4000/2011/02/fast-cakephp-search-with-indextank.html"><img src="http://www.travisberry.com/wp-content/uploads/2011/02/indextank.jpg" alt="Fast CakePHP Search With IndexTank" title="Fast CakePHP Search With IndexTank" width=20 height=20 /></a>
          
          <a href="http://localhost:4000/2011/01/haml-sass-markdown-and-cakephp-oh-my.html"><img src="http://www.travisberry.com/wp-content/uploads/2011/01/haml-sass.jpg" alt="Haml, Sass, Markdown, and CakePHP - Oh My!" title="Haml, Sass, Markdown, and CakePHP - Oh My!" width=20 height=20 /></a>
          
          <a href="http://localhost:4000/2011/01/new-time-tracking-web-app-homkora.html"><img src="http://www.travisberry.com/wp-content/uploads/2011/01/homkora-cap.jpg" alt="New Time Tracking Web App - Homkora" title="New Time Tracking Web App - Homkora" width=20 height=20 /></a>
          
        </div>
        <div id="wrapper" class="container_12">
          <!--<header id="header" class="grid_12">
          <h1><a href="/">Travis Berry</a></h1>
        </header>--> <!-- end header -->
				<div id="content">     
				  <nav>
					  <ul id="menu" class="clearfix">
					    <li class="link on first last" id="home-link"><a href="/"><span></span>Home</a></li>
							<li class="link on first last" id="home-link"><a href="/blog.html"><span></span>Blog</a></li>
							<li class="link on first last" id="home-link"><a href="/work.html"><span></span>Work</a></li>
							<li class="link on first last" id="home-link"><a href="/contact.html"><span></span>Contact</a></li>
					  </ul>
					  <br class="clear" />
					</nav>
				  <!-- Show a "Please Upgrade" box to both IE7 and IE6 users (Edit to IE 6 if you just want to show it to IE6 users) - jQuery will load the content from js/ie.html into the div -->
				  <!--[if lte IE 7]>
				  <div class="ie grid_7"></div>
				  <![endif]-->
					<div id="post">
<p><a href="http://www.flickr.com/photos/wwworks/612350664%20/"><img src="http://content.travisberry.com/soap.jpg" title="soap" alt="" /></a>Quick post to let everyone know of a good trick I just figured out. Most clean URL's are created through a rewrite and query page that does all the work. Sometimes though you just want to have a couple php scripts that you can link to like http://www.travisberry.com/example<!--more-->In Apache this is trivial. In Nginx, you can spend a couple days trying to get right. Turns out the solution is simple. If you use a block of code like this[cc lang="php"]## Parse all .php file in the /var/www directorylocation ~ .php$       location ~ .php$ {       fastcgi_split_path_info ^(.+.php)(.<em>)$;        fastcgi_pass 127.0.0.1:9000;        fastcgi_index  index.php;        fastcgi_param  SCRIPT_FILENAME  /var/www$fastcgi_script_name;        include fastcgi_params;        fastcgi_param  QUERY_STRING     $query_string;        fastcgi_param  REQUEST_METHOD   $request_method;        fastcgi_param  CONTENT_TYPE     $content_type;        fastcgi_param  CONTENT_LENGTH   $content_length;        fastcgi_intercept_errors        on;        fastcgi_ignore_client_abort     off;        fastcgi_connect_timeout 60;        fastcgi_send_timeout 180;        fastcgi_read_timeout 180;        fastcgi_buffer_size 128k;        fastcgi_buffers 4 256k;        fastcgi_busy_buffers_size 256k;        fastcgi_temp_file_write_size 256k;    }[/cc]to turn on PHP, just replace the location with[cc lang="php"]location ~ $[/cc]and comment out[cc lang="php"]##fastcgi_split_path_info ^(.+.php)(.</em>)$;[/cc]Your code block should now look like[cc lang="php"]## Parse all .php file in the /var/www directorylocation ~ .php$       location ~ $ {       ##fastcgi_split_path_info ^(.+.php)(.*)$;        fastcgi_pass 127.0.0.1:9000;        fastcgi_index  index.php;        fastcgi_param  SCRIPT_FILENAME  /var/www$fastcgi_script_name;        include fastcgi_params;        fastcgi_param  QUERY_STRING     $query_string;        fastcgi_param  REQUEST_METHOD   $request_method;        fastcgi_param  CONTENT_TYPE     $content_type;        fastcgi_param  CONTENT_LENGTH   $content_length;        fastcgi_intercept_errors        on;        fastcgi_ignore_client_abort     off;        fastcgi_connect_timeout 60;        fastcgi_send_timeout 180;        fastcgi_read_timeout 180;        fastcgi_buffer_size 128k;        fastcgi_buffers 4 256k;        fastcgi_busy_buffers_size 256k;        fastcgi_temp_file_write_size 256k;    }[/cc]Now instead of linking to /example.php, you can save the file with no extension, put it on your server, and link to /exampleNginx will now handle files without and extension as PHP files. This is a solution that will only fit a limited number of use cases, but compared to writing a rewrite wrapper, this is quick and easy.<script>utmx_section("contact1")</script><div id="contactme"><div class="avatar"><img src="http://www.gravatar.com/avatar/c9e8248c1237949b66a735bed64ae841?s=32&amp;d=identicon&amp;r=G" alt="" /></div>I'm just a guy interested in all things design and web related. You should <a href="http://www.travisberry.com/contact/">contact me</a> about about this article, for freelance work, or for any reason.</div></p>

</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>30 May 2011</span> &raquo; <a href="/2011/05/create-github-gist-with-ruby.html">Create GitHub Gist With Ruby</a></li>
    
      <li><span>26 May 2011</span> &raquo; <a href="/2011/05/write-text-anywhere-with-html5-canvas.html">Write Text Anywhere With HTML5 Canvas</a></li>
    
      <li><span>04 Mar 2011</span> &raquo; <a href="/2011/03/a-day-in-the-life-of-me.html">A Day In The Life Of Me</a></li>
    
  </ul>
</div>
				</div> <!-- end content -->
				<div class="clear"></div>
				<footer id="footer" class="grid_12">
				  <h1><a href="/">Travis Berry</a></h1>
				</footer> <!-- end footer -->
				<div class="clear"></div>
				</div> <!-- end wrapper -->
				  <script>

				(function ($) {
				  // custom css expression for a case-insensitive contains()
				  jQuery.expr[':'].Contains = function(a,i,m){
				      return (a.textContent || a.innerText || "").toUpperCase().indexOf(m[3].toUpperCase())>=0;
				  };


				  function listFilter(header, list) { // header is any element, list is an unordered list
				    // create and add the filter form to the header
				    var form = $("<form>").attr({"id":"searchFrom","class":"filterform","action":"#"}),
				        input = $("<input>").attr({"id":"search","class":"filterinput","type":"text","placeholder":"Search..."});
				    $(form).append(input).appendTo(header);

				    $(input)
				      .change( function () {
				        var filter = $(this).val();
				        if(filter) {
				          // this finds all links in a list that contain the input,
				          // and hide the ones not containing the input while showing the ones that do
				          $(list).find("h3:not(:Contains(" + filter + "))").parent().slideUp();
				          $(list).find("h3:Contains(" + filter + ")").parent().slideDown();
				        } else {
				          $(list).find("article").slideDown();
				        }
				        return false;
				      })
				    .keyup( function () {
				        // fire the above change event after every letter
				        $(this).change();
				    });
				  }


				  //ondomready
				  $(function () {
				    listFilter($("#search"), $("#list"));
				  });
				}(jQuery));

				  </script>
				</body>
				</html>