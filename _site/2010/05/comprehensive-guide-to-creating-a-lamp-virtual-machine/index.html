<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<title>How To Setup A LAMP Virtual Machine | Travis Berry</title>
		<meta name="author" content="Travis Berry">
		<!-- Mobile viewport optimized: j.mp/bplateviewport -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="shortcut icon" type="image/x-icon" href="http://www.travisberry.com/favicon.ico">
		<link href="http://static-assets1.travisberry.com/apple-touch/57.png" rel="apple-touch-icon" sizes="57x57" type="image/png" />
		<link href="http://static-assets1.travisberry.com/apple-touch/72.png" rel="apple-touch-icon" sizes="72x72" type="image/png" />
		<link href="http://static-assets1.travisberry.com/apple-touch/114.png" rel="apple-touch-icon" sizes="114x114" type="image/png" />
		
		<link rel="alternate" type="application/atom+xml" href="http://www.travisberry.com/atom.xml" />
		<link href="http://static-assets.travisberry.com/assets/application.css.gz" media="screen" rel="stylesheet" type="text/css" />
		<link rel="canonical" href="http://www.travisberry.com/2010/05/comprehensive-guide-to-creating-a-lamp-virtual-machine/" />
		<!--[if lt IE 9]>
			<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
		<![endif]-->
		<!--[if lte IE 7]>
			<link href="http://static.travisberry.com/sites/4ddebc054a2ab10001000007/theme/stylesheets/ie.css" media="screen" rel="stylesheet" type="text/css" />
			<script type="text/javascript" src="http://static-assets.travisberry.com/js/unitpngfix.js"></script>
		<![endif]-->
	</head>
	<body>
		<div id="topBar">
			
				<a href="http://www.travisberry.com/2012/04/real-time-in-place-editing-for-rails"><img src="http://static-assets3.travisberry.com/thumbnails/juggernaut_thumb.jpg" alt="Real-Time In Place Editing For Rails" title="Real-Time In Place Editing For Rails" width=20 height=20 /></a>
			
				<a href="http://www.travisberry.com/2012/02/hubot-deploy"><img src="http://static-assets3.travisberry.com/thumbnails/hubot-capistrano_thumb.jpg" alt="Hubot Deploy" title="Hubot Deploy" width=20 height=20 /></a>
			
				<a href="http://www.travisberry.com/2011/12/so-long-and-thanks-for-the-elephant"><img src="http://static-assets2.travisberry.com/thumbnails/elephant_thumb.jpg" alt="So Long And Thanks For The Elephant" title="So Long And Thanks For The Elephant" width=20 height=20 /></a>
			
				<a href="http://www.travisberry.com/2011/09/hospitium-new-open-source-project"><img src="http://static-assets1.travisberry.com/thumbnails/hospitium_thumb.jpg" alt="Hospitium - New Open Source Project" title="Hospitium - New Open Source Project" width=20 height=20 /></a>
			
				<a href="http://www.travisberry.com/2011/09/goodbye-wordpress-hello-jekyll"><img src="http://static-assets.travisberry.com/thumbnails/jekyll_thumb.jpg" alt="Goodbye WordPress - Hello Jekyll" title="Goodbye WordPress - Hello Jekyll" width=20 height=20 /></a>
			
				<a href="http://www.travisberry.com/2011/05/create-github-gist-with-ruby"><img src="http://static-assets.travisberry.com/thumbnails/gists_thumb.jpg" alt="Create GitHub Gist With Ruby" title="Create GitHub Gist With Ruby" width=20 height=20 /></a>
			
			<noscript style="font-size:12px;vertical-align:middle;">
				For full functionality of this site it is necessary to enable JavaScript.
				Here are the <a href="http://www.enable-javascript.com/" target="_blank">
				instructions how to enable JavaScript in your web browser</a>.
				<style>
					pre{
					  text-shadow: none !important;
					  font-size:14px;
					  background-color: #111111;
					  color: #CAF715;
						padding:10px;
						margin-bottom:20px;
						overflow:auto;
					}
				</style>
			</noscript>
		</div>
		<div id="wrapper" class="container_12">
			<div id="content">
				<nav>
					<ul id="menu" class="clearfix">
						<li class="link on first last" id="home-link"><a href="/"><span></span>Home</a></li>
						<li class="link on first last" id="blog-link"><a href="/blog/"><span></span>Blog</a></li>
						<li class="link on first last" id="work-link"><a href="/work/"><span></span>Work</a></li>
						<li class="link on first last" id="contact-link"><a href="/contact/"><span></span>Contact</a></li>
					</ul>
					<br class="clear" />
				</nav>
				<div id="post">
<p><article class="post clearfix">
  <h3>How To Setup A LAMP Virtual Machine</h3>
  <a href="http://oldstatic.travisberry.com/wp-content/uploads/2010/05/oldcomp.jpg" class="postImageLink"><img src="http://oldstatic3.travisberry.com/wp-content/uploads/2010/05/oldcomp.jpg" alt="" class="thumbnail alignleft" width=640  /></a>
  <h6>Published: 2010-05-09</h6></p>

<p>In an effort to develop in an environment closer to many production servers, many people have begun developing in virtual machines running on their host os. This article is a comprehensive guide to creating a LAMP virtual machine (plus a few other goodies).</p>

<p>First you need the virtual machine software. Download <a href="http://www.virtualbox.org/wiki/Downloads">VirtualBox</a> and install it on your host os. Once installed go download the latest version of <a href="http://www.ubuntu.com/GetUbuntu/download">Ubuntu</a>. You want the desktop version, not the server. Save the .iso file to your desktop.</p>

<h2>VirtualBox Setup &amp; Ubuntu Installation</h2>

<p>Launch VirtualBox and create a new machine by clicking the button in the top left corner. Click next on the screen the comes up. Create a name for your new machine, and select Linux as your Operating System, and Ubuntu as you Version. Select a base amount of memory for the virtual machine to use. Use at least the default settings, but use as much as your system can spare. I recommend setting it to no more than 50% of your total RAM, unless you have lots to spare. Hit next. On the next screen select the option to create a new hard disk. This will launch the Create New Virtual Disk Wizard. Hit next. Select dynamically expanding storage and hit next. Select the size of the hard disk you want the virtual machine to have. This does take up real space on you computer. The default of 8 gigs should be sufficient for most. On the next screen hit finish. Then finish again.</p>

<p>Now with your new machine highlighted, click the start button. This will launch two new windows, one of them being the First Run Wizard. Hit next on the first screen. Select CD/DVD ROM Device. Then click the little folder next to the drop down list. Hit add and select the Ubuntu .iso file you save to your desktop. Highlight it and hit select. Hit next on the Select Installation Media page. Finish.</p>

<p>The Ubuntu .iso file will now start to run in the other window. When the install screen comes up select your language and hit the Install button, not the try button. On the next page select your time zone. Then pick your keyboard on the next screen. On the Prepare disk space page select the option to erase and use the entire disk then hit forward. Next fill out your user information. Make sure to set a password. On the next page hit install.</p>

<p>If you find you cant get your mouse back out of the virtual machine, look in the bottom right corner of the window. It should give you a short cut or a ket on your keyboard that when pressed will return your mouse to the host os.</p>

<p>When the installation is complete you will need to restart the computer. When it says, Please remove the disc and close the tray (if any) then press enter:, pull your mouse back out of the virtual machine and look at the bottom of the window. There should be an icon that looks like a CD. Click it and select unmount CD/DVD Device. Now click back in the Ubuntu window and hit enter. When the computer finishes restarting you will now have a working Ubuntu copy installed on your host os.</p>

<p>You may or may not be able to connect to the internet through your virtual machine by default. Check by launching Firefox and seeing if you have a connection. If you do not. Close the virtual machine. You can select shutdown from the system options or just close the window and choose power down. In the virtual box window select your virtual machine from the list on the left hand side and select Settings. Select Network from the top menu. Under Adapter 1 make sure Enable Network Adapter is checked, but change the Attached To drop down list from NAT to bridged adapter. Hit OK and restart the machine. You should now be able to connect to the internet.</p>

<p>Now that Ubuntu is installed and working it's time to start installing the LAMP stack. For those who don't know, LAMP stands for <a href="http://www.linux.org/">Linux</a>, <a href="http://www.apache.org/">Apache</a>, <a href="http://www.mysql.com/">MySQL</a>, and <a href="http://php.net/index.php">PHP</a>. This is a common setup among web developers, but you could also install Ruby or any other language. This one will focus just on the LAMP stack. (which is what you want if you use, wordpress, joomla, drupal, cakephp, or any of the other fine php packages)</p>

<h2>Install Apache 2</h2>

<p>Now open up Terminal (Applications > accessories > Terminal). Type in the following,</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example1.txt'></script><noscript><pre><code>sudo apt-get install apache2</code></pre></noscript>
</div>


<p>Terminal will prompt for your password. Enter it in.(Terminal does not show your password as you type, so just type it in and hit enter).</p>

<h2>Install PHP 5</h2>

<p>Apache should now be installed on your system. Now it's time to install PHP 5. In terminal type,</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example2.txt'></script><noscript><pre><code>sudo apt-get install php5 libapache2-mod-php5</code></pre></noscript>
</div>


<h2>Install MySQL</h2>

<p>Now you have PHP 5 installed. To install MySQL type,</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example3.txt'></script><noscript><pre><code>sudo apt-get install mysql-server</code></pre></noscript>
</div>


<p>Enter in a password when the install prompts you to.</p>

<h2>Install phpMyAdmin</h2>

<p>Now install <a href="http://www.phpmyadmin.net/home_page/index.php">phpMyAdmin</a> by typing</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example4.txt'></script><noscript><pre><code>sudo apt-get install libapache2-mod-auth-mysql php5-mysql phpmyadmin</code></pre></noscript>
</div>


<p>When phpmyadmin asks which server to use select apache. It will then ask to create a database. Tell it to do so and enter in the password you set when installing MySQL.</p>

<p>After installing all this you need to restart apache. To do so type</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example5.txt'></script><noscript><pre><code>sudo /etc/init.d/apache2 restart</code></pre></noscript>
</div>


<h2>Test Installation</h2>

<p>You should now have a working LAMP stack installed. To test everything is working, type in Terminal</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example6.txt'></script><noscript><pre><code>gksudo gedit /var/www/info.php</code></pre></noscript>
</div>


<p>When the new window opens add</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example7.php'></script><noscript><pre><code>&lt;?php phpinfo(); ?&gt;</code></pre></noscript>
</div>


<p>Save and close the window. Now open Firefox and go to http://localhost/</p>

<p>You should see "It Works!", if you do, apache is working, then go to http://localhost/info.php</p>

<p>If you see a long list of information about PHP 5 then it works as well.</p>

<p>Now everything is working as it should, but the default setup isn't the best thing. We're going to do a little bit more to make it a development dream come true.</p>

<h2>Fix Domain Name Error</h2>

<p>First you may have noticed when we restarted apache that it gave an error about not being able to determine the fully qualified domain name. To fix this error open the terminal and type,</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example8.txt'></script><noscript><pre><code>gksudo gedit /etc/apache2/httpd.conf</code></pre></noscript>
</div>


<p>Add to the file</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example9.txt'></script><noscript><pre><code>ServerName localhost</code></pre></noscript>
</div>


<p>Save and exit. Now restart again. You should no longer see an error.</p>

<h2>Install mod_rewrite</h2>

<p>Now lets add an important PHP 5 module. mod_rewrite. Many systems use this to turn ugly urls like,</p>

<p>example.com/?dkjfodocas223</p>

<p>into</p>

<p>example.com/about/</p>

<p>You can enable the module by typing in the Terminal</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176993.js?file=example10.txt'></script><noscript><pre><code>sudo a2enmod rewrite</code></pre></noscript>
</div>


<h2>Enable PHP 5 Error Displaying</h2>

<p>Another helpful feature not enabled by default is error displaying in PHP. Now on a production server it is good to turn these off, but when developing, they can be handy to have on. To enable type</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176996.js?file=example11.txt'></script><noscript><pre><code>gksudo gedit /etc/php5/apache2/php.ini</code></pre></noscript>
</div>


<p>Make sure the following lines read as follows</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176996.js?file=example12.txt'></script><noscript><pre><code>display_errors = On

display_startup_errors = On

log_errors = On

error_log = /pickadirectorytostoreerrors/phperror.log

error_reporting = E_ALL &amp; E_STRICT</code></pre></noscript>
</div>


<h2>Setup Virtual Hosts</h2>

<p>After errors are turned on, let's setup an example virtual host. Virtual hosts are what allow you to host multiple websites on one server. This will allow example.com and test.com to point to two different sites.</p>

<p>To begin setting this up create two separate folders in /var/www/. Name one example.com and the other test.com. Create a simple index.html file in each, creating content that makes them easy to tell apart. Now cd to /etc/apache2/sites-enabled. Once there, type the following in Terminal</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176996.js?file=example13.txt'></script><noscript><pre><code>gksudo gedit example.com</code></pre></noscript>
</div>


<p>Inside the file paste the following,</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176996.js?file=example14.txt'></script><noscript><pre><code>&lt;VirtualHost *:80&gt;
ServerAdmin your@email.com
ServerAlias www.example.com
DocumentRoot /var/www/example.com
        &lt;Directory /&gt;
                Options FollowSymLinks
                AllowOverride All
        &lt;/Directory&gt;
        &lt;Directory /var/www/example.com/&gt;
                Options Indexes FollowSymLinks MultiViews
                AllowOverride All
                Order allow,deny
                allow from all
        &lt;/Directory&gt;
        ErrorLog /var/www/example.com/logs/example-error.log
        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn
 CustomLog /var/www/example.com/logs/example-access.log combined
&lt;/VirtualHost&gt;</code></pre></noscript>
</div>


<p>Now create a link to the file in sites-available.</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176996.js?file=example15.txt'></script><noscript><pre><code>sudo ln -s /etc/apache2/sites-available/example.com</code></pre></noscript>
</div>


<p>Next let's create one for test.com</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176996.js?file=example16.txt'></script><noscript><pre><code>gksudo gedit test.com</code></pre></noscript>
</div>


<p>Inside the file paste the following,</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176996.js?file=example17.txt'></script><noscript><pre><code>&lt;VirtualHost *:80&gt;
ServerAdmin your@email.com
ServerAlias www.test.com
DocumentRoot /var/www/test.com
        &lt;Directory /&gt;
                Options FollowSymLinks
                AllowOverride All
        &lt;/Directory&gt;
        &lt;Directory /var/www/test.com/&gt;
                Options Indexes FollowSymLinks MultiViews
                AllowOverride All
                Order allow,deny
                allow from all
        &lt;/Directory&gt;
        ErrorLog /var/www/test.com/logs/example-error.log
        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn
 CustomLog /var/www/test.com/logs/example-access.log combined
&lt;/VirtualHost&gt;</code></pre></noscript>
</div>


<p>Now create a link to the file in sites-available.</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176996.js?file=example18.txt'></script><noscript><pre><code>sudo ln -s /etc/apache2/sites-available/test.com</code></pre></noscript>
</div>


<p>Now your virtual hosts are ready to go, but first we need to tell the computer to listen for the addresses. To do that type the following,</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176996.js?file=example19.txt'></script><noscript><pre><code>cd /etc/</code></pre></noscript>
</div>


<p>Then</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176998.js?file=example20.txt'></script><noscript><pre><code>gksudo gedit hosts</code></pre></noscript>
</div>


<p>Create a new line under the first. In it add</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176998.js?file=example21.txt'></script><noscript><pre><code>127.0.0.1  localhost www.example.com</code></pre></noscript>
</div>


<p>Create another line and this time add</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176998.js?file=example22.txt'></script><noscript><pre><code>127.0.0.1  localhost www.test.com</code></pre></noscript>
</div>


<p>Save and close the file. Restart apache</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176998.js?file=example23.txt'></script><noscript><pre><code>sudo /etc/init.d/apache2 restart</code></pre></noscript>
</div>


<p>Now open Firefox and go to www.example.com. You should see your example.com index.html file. Now try www.test.com. If you see your test.com index.html file everything works as it should. Just repeat this process for any additional domains you would like to add.</p>

<p>If you want to be able to view your virtual machine sites in a browser on your host os you need to do a similar thing as the last step. First find the local IP address of the virtual machine. You can find this by going to System > Administration > Network Tools. Select your Network Device from the drop down and look for the Ipv4 IP Address. Let's say mine is 192.168.10.4</p>

<p>Now move back to your host os. Open a terminal session in it. Find your hosts file. In OSX it is /etc/ just like Linux. Now add lines like so,</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176998.js?file=example24.txt'></script><noscript><pre><code>192.168.10.4 www.example.com
192.168.10.4 www.test.com</code></pre></noscript>
</div>


<p>You should now be able to view your example sites in a browser on your host os.</p>

<h2>Change Webroot Permissions</h2>

<p>Everything is starting to work quite well for development but there are still a few extras worth setting up. The first is changing permissions of your web root. To make you the owner of the /var/www directory type this in Terminal</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176998.js?file=example25.txt'></script><noscript><pre><code>sudo chown youruser:youruser /var/www</code></pre></noscript>
</div>


<h2>Install Git</h2>

<p>This will now allow your user to easily create new folders and files. Next lets install my favorite version control system <a href="http://git-scm.com/">Git</a>. To install type this into Terminal</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176998.js?file=example26.txt'></script><noscript><pre><code>sudo apt-get install git-core</code></pre></noscript>
</div>


<h2>Install FTP</h2>

<p>You can now use git to control the code you develop on the machine. Next let's add ftp support to make moving files between your host and guest operating systems a little easier. To install ftp support type,</p>

<div class="gistFallback">
<script src='https://gist.github.com/1176998.js?file=example27.txt'></script><noscript><pre><code>sudo apt-get install proftpd</code></pre></noscript>
</div>


<p>You can now open your favorite ftp application in your host os and connect to your virtual machine. Just use the IP (mine in this example is 192.168.10.4) and enter in your user name and password. Ta-da!</p>

<hr />

<p>There you go. You now have a complete and awesome new development virtual machine. If there are any questions, or if you know a better way to do something, please let me know in the comments.
</article></p>

</div>
<p>Continue the discussion on twitter. <a href="https://twitter.com/#!/travisberry">@travisberry</a></p>
<div id="related">
  <h2>Probably Not Related Posts</h2>
  <ul class="posts">
    
      <li><span>07 Apr 2012</span> &raquo; <a href="/2012/04/real-time-in-place-editing-for-rails">Real-Time In Place Editing For Rails</a></li>
    
      <li><span>16 Feb 2012</span> &raquo; <a href="/2012/02/hubot-deploy">Hubot Deploy</a></li>
    
      <li><span>24 Dec 2011</span> &raquo; <a href="/2011/12/so-long-and-thanks-for-the-elephant">So Long And Thanks For The Elephant</a></li>
    
  </ul>
</div>
			</div> <!-- end content -->
			<div class="clear"></div>
			<footer id="footer" class="grid_12">
				<h1><a href="/">Travis Berry</a></h1>
			</footer> <!-- end footer -->
			<div class="clear"></div>
		</div> <!-- end wrapper -->
		<a href="#top" id="top-link">&and;</a>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
		<script src="http://static-assets.travisberry.com/assets/application.js.gz"></script>
		<script type="text/javascript">
		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-11593601-1']);
		  _gaq.push(['_trackPageview']);
		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();
		</script>
	</body>
</html>