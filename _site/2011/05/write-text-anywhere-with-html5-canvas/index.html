<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<title>Write Text Anywhere With HTML5 Canvas | Travis Berry</title>
		<meta name="author" content="Travis Berry">
		<!-- Mobile viewport optimized: j.mp/bplateviewport -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="alternate" type="application/atom+xml" href="http://www.travisberry.com/atom.xml" />
		<link href="http://travisberry-static.s3-website-us-east-1.amazonaws.com/css/style.css" media="screen" rel="stylesheet" type="text/css" />
		<!--[if lt IE 9]>
			<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
		<![endif]-->
		<!--[if lte IE 7]>
			<link href="http://static.travisberry.com/sites/4ddebc054a2ab10001000007/theme/stylesheets/ie.css" media="screen" rel="stylesheet" type="text/css" />
		<![endif]-->
	</head>
	<body>
		<div id="topBar">
			
				<a href="http://travisberry-static.s3-website-us-east-1.amazonaws.com/2011/05/create-github-gist-with-ruby"><img src="http://oldstatic.travisberry.com/wp-content/uploads/2011/05/gists.jpg" alt="Create GitHub Gist With Ruby" title="Create GitHub Gist With Ruby" width=20 height=20 /></a>
			
				<a href="http://travisberry-static.s3-website-us-east-1.amazonaws.com/2011/05/write-text-anywhere-with-html5-canvas"><img src="http://oldstatic.travisberry.com/wp-content/uploads/2011/05/canvas.jpg" alt="Write Text Anywhere With HTML5 Canvas" title="Write Text Anywhere With HTML5 Canvas" width=20 height=20 /></a>
			
				<a href="http://travisberry-static.s3-website-us-east-1.amazonaws.com/2011/03/a-day-in-the-life-of-me"><img src="http://static.travisberry.com/sites/4ddebc054a2ab10001000007/assets/4de4286bd48c1200010000c7/selfhomecrop2.jpg" alt="A Day In The Life Of Me" title="A Day In The Life Of Me" width=20 height=20 /></a>
			
				<a href="http://travisberry-static.s3-website-us-east-1.amazonaws.com/2011/02/fast-cakephp-search-with-indextank"><img src="http://oldstatic.travisberry.com/wp-content/uploads/2011/02/indextank.jpg" alt="Fast CakePHP Search With IndexTank" title="Fast CakePHP Search With IndexTank" width=20 height=20 /></a>
			
				<a href="http://travisberry-static.s3-website-us-east-1.amazonaws.com/2011/01/haml-sass-markdown-and-cakephp-oh-my"><img src="http://oldstatic.travisberry.com/wp-content/uploads/2011/01/haml-sass.jpg" alt="Haml, Sass, Markdown, and CakePHP - Oh My!" title="Haml, Sass, Markdown, and CakePHP - Oh My!" width=20 height=20 /></a>
			
				<a href="http://travisberry-static.s3-website-us-east-1.amazonaws.com/2011/01/new-time-tracking-web-app-homkora"><img src="http://oldstatic.travisberry.com/wp-content/uploads/2011/01/homkora-cap.jpg" alt="New Time Tracking Web App - Homkora" title="New Time Tracking Web App - Homkora" width=20 height=20 /></a>
			
		</div>
		<div id="wrapper" class="container_12">
			<div id="content">     
				<nav>
					<ul id="menu" class="clearfix">
						<li class="link on first last" id="home-link"><a href="/"><span></span>Home</a></li>
						<li class="link on first last" id="blog-link"><a href="/blog/"><span></span>Blog</a></li>
						<li class="link on first last" id="work-link"><a href="/work/"><span></span>Work</a></li>
						<li class="link on first last" id="contact-link"><a href="/contact/"><span></span>Contact</a></li>
					</ul>
					<br class="clear" />
				</nav>
				<div id="post">
<p><article class="post clearfix">
  <h3>Write Text Anywhere With HTML5 Canvas</h3>
  <a href="http://www.flickr.com/photos/paurian/3683348208/" class="postImageLink"><img src="http://oldstatic.travisberry.com/wp-content/uploads/2011/05/canvas.jpg" alt="" class="thumbnail alignleft" width=640 height=280 /></a>
  <h6>Published: May 26, 2012</h6></p>

<p>When working on a project recently I came across the need to be able to add some text to a canvas element. This by itself wasn't particularly hard, as there are several examples of creating text editor apps with canvas, but those all forced the text into a row style grid like a text editor. What I needed was a little more freeform in that I wanted the user to click and the text to show at that point.</p>

<p>After a little hacking around I came up with something that handled my needs and hopefully may help someone else in the future.</p>

<p>(This doesn't look the best in the end, but you can easily add some css styles to make it look better)</p>

<p><a href="http://oldstatic.travisberry.com/demos/canvas-text-demo/index.html">Click Here To See Demo</a></p>

<p>So first we need to create a canvas element</p>

<script src="https://gist.github.com/1177318.js?file=example1.html"></script>


<p>Now we have the canvas element all set up we can start having some fun.</p>

<p>Well not quite. First we need to set some dimensions for the canvas element. Without them, it doesn't have any way to know where to place our "drawings".</p>

<p>Add this into a css file</p>

<script src="https://gist.github.com/1177318.js?file=example2.css"></script>


<p>Now we can start adding drawings. One thing we are going to need for this is a text entry box. I debated trying to "type" directly into the canvas but decided against it. (for complexity reasons)</p>

<p>The method I chose was to add a textarea to the position of the click in the canvas. The user will enter their text into the textarea popup and hit save. This will then draw the text to the screen.</p>

<p>Let's go ahead and create a javascript function to handle the click and add the textarea and save button.</p>

<script src="https://gist.github.com/1177318.js?file=example3.js"></script>


<p>Thereâ€™s nothing too crazy in here. It does do a check and destroy the textarea if one is already displayed while the user clicks the canvas again.</p>

<script src="https://gist.github.com/1177318.js?file=example4.js"></script>


<p>These are setting the position of the mouse click so we can use them to set the position to display the textarea at. It takes into account any offsets the canvas element may have as well.</p>

<p>The rest is just appending the textarea to the main element in the page. The save button has an onclick event that we will deal with in a bit.</p>

<p>Now we have to actually draw the entered text to the screen.</p>

<script src="https://gist.github.com/1177318.js?file=example5.js"></script>


<p>So this is fairly intense. It also uses a little library file from Jim Studt that you can find <a href="http://www.federated.com/~jim/canvastext/">here</a>. Though I have modified mine a bit because of some conflicts it was causing me. You can grab my copy at <a href="https://github.com/ninetwentyfour/Video-Canvas/blob/master/js/text.js">https://github.com/ninetwentyfour/Video-Canvas/blob/master/js/text.js</a></p>

<p>A few important parts in that code are</p>

<script src="https://gist.github.com/1177318.js?file=example6.js"></script>


<p>This is going to another function that we will write in a minute. Basically it is solving the problem of canvas text not having any idea how to word wrap. It will blow right off the page without this.</p>

<script src="https://gist.github.com/1177318.js?file=example7.js"></script>


<p>This intializes the text library file.</p>

<script src="https://gist.github.com/1177318.js?file=example8.js"></script>


<p>This is the block that actually draws the text to the screen. It takes each entry in the phraseArray and draws it to the screen moving it down by a line each time.</p>

<p>The code to control the width of the text looks like this</p>

<script src="https://gist.github.com/1177318.js?file=example9.js"></script>


<p>This takes the canvas variable the original text and the width you want to limit it to then returns an array of pharses limited to the length you pass.</p>

<p>Once you have all this done you should have a working example. My final code looks like this.</p>

<script src="https://gist.github.com/1177318.js?file=example10.html"></script>


<p>This is a pretty basic and is missing a few things that would make it more helpful but it should give you a good start. Please feel free to leave questions or advice on better ways to do this in the comments.</p>

<p></article></p>

</div>
<p>Comments have been removed in my sites latest upgrade. They may or may not come back.</p>
<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>30 May 2011</span> &raquo; <a href="/2011/05/create-github-gist-with-ruby">Create GitHub Gist With Ruby</a></li>
    
      <li><span>04 Mar 2011</span> &raquo; <a href="/2011/03/a-day-in-the-life-of-me">A Day In The Life Of Me</a></li>
    
      <li><span>16 Feb 2011</span> &raquo; <a href="/2011/02/fast-cakephp-search-with-indextank">Fast CakePHP Search With IndexTank</a></li>
    
  </ul>
</div>
			</div> <!-- end content -->
			<div class="clear"></div>
			<footer id="footer" class="grid_12">
				<h1><a href="/">Travis Berry</a></h1>
			</footer> <!-- end footer -->
			<div class="clear"></div>
		</div> <!-- end wrapper -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
		<script src="/javascript/search.js"></script>
	</body>
</html>